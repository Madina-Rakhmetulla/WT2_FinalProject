<!doctype html>
<html data-bs-theme="dark" lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Admin — Online Library</title>
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  </head>
  <body>
    <a class="skip" href="#main">Skip to content</a>

    <header class="site-header">
      <div class="container navbar">
        <a class="brand" href="index.html" aria-label="Home">
          <span class="brand-logo" aria-hidden="true"></span>
          <span>Online Library</span>
        </a>
        <label for="nav-toggle" class="hamb" aria-label="Toggle navigation"><span></span><span></span><span></span></label>
        <input type="checkbox" id="nav-toggle" aria-hidden="true">
        <nav class="nav-links" aria-label="Primary">
          <a href="catalog.html">Catalog</a>
          <a href="categories.html">Authors</a>
          <a href="membership.html">Membership</a>
          <a href="about.html">About</a>
          <a href="faq.html">FAQ</a>
          <a href="contact.html">Contact</a>
          <a href="account.html">Account</a>
          <span id="navUser" class="badge bg-secondary ms-2" style="align-self:center"></span>
          <button id="themeToggle" class="btn btn-outline-light btn-sm ms-2" type="button">Light mode</button>
        </nav>
      </div>
    </header>

    <main id="main" class="container" style="max-width: 980px;">
      <div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mb-3">
        <h1 class="mb-0">Admin Panel</h1>
        <div class="d-flex gap-2 flex-wrap">
          <a class="btn btn-outline-secondary btn-sm" href="catalog.html">Back to Catalog</a>
          <button id="logoutBtn" class="btn btn-outline-danger btn-sm" type="button">Logout</button>
          <a class="btn btn-outline-light btn-sm" href="auth.html">Login</a>
        </div>
      </div>

      <div id="adminGate" class="alert alert-warning" style="display:none;">
        <strong>Admins only.</strong> Please login as an <strong>admin</strong> on <a href="auth.html">Login</a>.
      </div>

      <div id="adminContent" data-admin-only style="display:none;">
        <p class="text-secondary mb-4">
          Manage <strong>Authors</strong>, <strong>Books</strong>, <strong>Members</strong>, and <strong>Loans</strong>. All write actions are protected by JWT + RBAC.
        </p>

        <ul class="nav nav-pills gap-2 mb-3" id="adminTabs" role="tablist">
          <li class="nav-item" role="presentation">
            <button class="nav-link active" id="tab-authors" data-bs-toggle="pill" data-bs-target="#pane-authors" type="button" role="tab">Authors</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="tab-books" data-bs-toggle="pill" data-bs-target="#pane-books" type="button" role="tab">Books</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="tab-members" data-bs-toggle="pill" data-bs-target="#pane-members" type="button" role="tab">Members</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="tab-loans" data-bs-toggle="pill" data-bs-target="#pane-loans" type="button" role="tab">Loans</button>
          </li>
        </ul>

        <div class="tab-content">
          <!-- AUTHORS -->
          <section class="tab-pane fade show active" id="pane-authors" role="tabpanel" aria-labelledby="tab-authors">
            <div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mb-2">
              <h2 class="h4 mb-0">Authors</h2>
              <button class="btn btn-primary btn-sm" id="addAuthorBtn" type="button">Add Author</button>
            </div>
            <div class="table-responsive">
              <table class="table table-dark table-hover align-middle">
                <thead>
                  <tr>
                    <th style="width: 34%;">Full Name</th>
                    <th style="width: 14%;">Birth Year</th>
                    <th style="width: 160px;" class="text-end">Actions</th>
                  </tr>
                </thead>
                <tbody id="authorsTbody"></tbody>
              </table>
            </div>
          </section>

          <!-- BOOKS -->
          <section class="tab-pane fade" id="pane-books" role="tabpanel" aria-labelledby="tab-books">
            <div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mb-2">
              <h2 class="h4 mb-0">Books</h2>
              <button class="btn btn-primary btn-sm" id="addBookBtn" type="button">Add Book</button>
            </div>
            <div class="table-responsive">
              <table class="table table-dark table-hover align-middle">
                <thead>
                  <tr>
                    <th style="width: 34%;">Title</th>
                    <th style="width: 12%;">Year</th>
                    <th style="width: 24%;">Author</th>
                    <th style="width: 160px;" class="text-end">Actions</th>
                  </tr>
                </thead>
                <tbody id="booksTbody"></tbody>
              </table>
            </div>
          </section>

          <!-- MEMBERS -->
          <section class="tab-pane fade" id="pane-members" role="tabpanel" aria-labelledby="tab-members">
            <div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mb-2">
              <h2 class="h4 mb-0">Members</h2>
              <button class="btn btn-primary btn-sm" id="addMemberBtn" type="button">Add Member</button>
            </div>
            <div class="table-responsive">
              <table class="table table-dark table-hover align-middle">
                <thead>
                  <tr>
                    <th style="width: 18%;">First</th>
                    <th style="width: 18%;">Last</th>
                    <th style="width: 28%;">Email</th>
                    <th style="width: 18%;">Country</th>
                    <th style="width: 12%;">Gender</th>
                    <th style="width: 160px;" class="text-end">Actions</th>
                  </tr>
                </thead>
                <tbody id="membersTbody"></tbody>
              </table>
            </div>
          </section>

          <!-- LOANS -->
          <section class="tab-pane fade" id="pane-loans" role="tabpanel" aria-labelledby="tab-loans">
            <div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mb-2">
              <h2 class="h4 mb-0">Loans</h2>
              <button class="btn btn-primary btn-sm" id="addLoanBtn" type="button">Create Loan</button>
            </div>
            <div class="table-responsive">
              <table class="table table-dark table-hover align-middle">
                <thead>
                  <tr>
                    <th style="width: 26%;">Book</th>
                    <th style="width: 20%;">Author</th>
                    <th style="width: 22%;">Member</th>
                    <th style="width: 16%;">Borrowed</th>
                    <th style="width: 16%;">Status</th>
                    <th style="width: 180px;" class="text-end">Actions</th>
                  </tr>
                </thead>
                <tbody id="loansTbody"></tbody>
              </table>
            </div>
            <div class="alert alert-secondary mt-3">
              <small>
                Rule: a book can have only one <strong>active</strong> loan at a time. Mark as returned to make it available again.
              </small>
            </div>
          </section>
        </div>
      </div>

      <!-- AUTHOR MODAL -->
      <div class="modal fade" id="authorModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="authorModalTitle">Add Author</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form id="authorForm" class="vstack gap-3">
                <input type="hidden" id="authorId" />
                <div>
                  <label class="form-label">Full Name</label>
                  <input class="form-control" id="authorName" required />
                </div>
                <div>
                  <label class="form-label">Birth Year</label>
                  <<input class="form-control" id="authorBirthYear" type="number" min="0" />
                </div>
                <button class="btn btn-primary w-100" type="submit" id="authorSaveBtn">Save</button>
              </form>
            </div>
          </div>
        </div>
      </div>

      <!-- BOOK MODAL -->
      <div class="modal fade" id="bookModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="bookModalTitle">Add Book</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form id="bookForm" class="vstack gap-3">
                <input type="hidden" id="bookId" />
                <div>
                  <label class="form-label">Title</label>
                  <input class="form-control" id="bookTitle" required />
                </div>
                <div class="row g-2">
                  <div class="col-md-4">
                    <label class="form-label">Year</label>
                    <input class="form-control" id="bookYear" type="number" min="0" />
                  </div>
                  <div class="col-md-8">
                    <label class="form-label">Author</label>
                    <select class="form-select" id="bookAuthor" required></select>
                  </div>
                </div>
                <button class="btn btn-primary w-100" type="submit" id="bookSaveBtn">Save</button>
              </form>
            </div>
          </div>
        </div>
      </div>

      <!-- MEMBER MODAL -->
      <div class="modal fade" id="memberModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="memberModalTitle">Add Member</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form id="memberForm" class="vstack gap-3">
                <input type="hidden" id="memberId" />
                <div>
                  <label class="form-label">First Name</label>
                  <input class="form-control" id="memberFirstName" required />
                </div>
                <div>
                  <label class="form-label">Email</label>
                  <input class="form-control" id="memberEmail" type="email" required />
                </div>
                <div>
                  <label class="form-label">Last Name</label>
                  <input class="form-control" id="memberLastName" />
                </div>
                <div>
                  <label class="form-label">Country</label>
                  <input class="form-control" id="memberCountry" required />
                </div>
                <div>
                  <label class="form-label">Gender</label>
                  <select class="form-select" id="memberGender">
                    <option value="">—</option>
                    <option value="female">female</option>
                    <option value="male">male</option>
                    <option value="other">other</option>
                  </select>
                </div>
                <div>
                  <label class="form-label">Hobbies (comma-separated)</label>
                  <input class="form-control" id="memberHobbies" placeholder="reading, chess, coding" />
                </div>

                <button class="btn btn-primary w-100" type="submit" id="memberSaveBtn">Save</button>
              </form>
            </div>
          </div>
        </div>
      </div>

      <!-- LOAN MODAL -->
      <div class="modal fade" id="loanModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="loanModalTitle">Create Loan</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form id="loanForm" class="vstack gap-3">
                <div>
                  <label class="form-label">Member</label>
                  <select class="form-select" id="loanMember" required></select>
                </div>
                <div>
                  <label class="form-label">Book</label>
                  <select class="form-select" id="loanBook" required></select>
                  <div class="form-text">Only books that are not currently on an active loan are shown.</div>
                </div>
                <button class="btn btn-primary w-100" type="submit" id="loanSaveBtn">Create</button>
              </form>
            </div>
          </div>
        </div>
      </div>
</main>

    <footer>
      <div class="container">
        <div class="footer-grid">
          <div>
            <h3>Online Library</h3>
            <p class="muted">Read anywhere. Discover new knowledge.</p>
          </div>
          <div>
            <h3>Explore</h3>
            <p><a href="catalog.html">Catalog</a><br><a href="categories.html">Authors</a></p>
          </div>
          <div>
            <h3>Company</h3>
            <p><a href="about.html">About</a><br><a href="privacy.html">Privacy</a><br><a href="terms.html">Terms</a></p>
          </div>
          <div>
            <h3>Account</h3>
            <p><a href="register.html">Login</a><br><a href="account.html">Dashboard</a></p>
          </div>
        </div>
        <p class="muted" style="margin-top:1rem">© 2025 Online Library — Madina Rakhmetulla</p>
      </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"
            integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
            crossorigin="anonymous"></script>
<script src="js/library.js"></script>
    <script src="js/admin-panel.js"></script>
  </body>
</html>
